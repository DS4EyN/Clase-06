---
title: "Visualización de datos en R"
author: "Javier Fernández - Carolina Molinare"
date: "5 de Mayo de 2020"
output: ioslides_presentation
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
library(data.table)
library(ggplot2)
library(plotly)
```

# Introducción a la visualización de datos

## Contenidos

- Revisión del curso hasta ahora
- ¿Qué es importante en el análisis de datos?
  - El promedio
  - Gráficos en el análisis estadísitico ¿Por qué son necesarios?
- Visualización de datos
  - Objetivo de la visualización
    - Categorías 
    - Relaciones
    - Tendencias
    - Mix
  
## En este curso...

- Hemos aprendido a trabajar bases de datos
- Pero el procesos de hacer ciencia de datos comprende otras etapas

```{r,out.width = '100%', fig.align='center'}
knitr::include_graphics("Imagen 1.png")
```

## Pregunta abierta

Imagínense que en la siguiente tarea, se les entrega una base de datos que contiene información acerca de la edad de las personas y el consumo de Coca-Cola. Sí les pidiera caracterizar a los individuos con un solo indicador:

                        ¿Qué indicador utilizarían? 

## El promedio

- Es un estadístico descriptivo que nos permite caracterizar o condensar información de una variable
- Tiene la cualidad de cumplir una propiedad interesante:
  - Es el número más cercano a los que se usaron para construirlo (minimiza la suma de las distancias euclidianas): Es el mejor representante de los datos
- Pero, ¿Puede un solo indicador representar una multiplicidad de patrones que se encuentran en los datos?

## F.J Anscombe (1973), The American Statistician Journal

```{r,out.width = '60%', fig.align='center'}
knitr::include_graphics("Imagen 2.png")
```

## Utilicemos el ejemplo de este paper

Utilizando 4 bases de datos de juguete, calcular los principales estadísticos descriptivos de un análisis de regresión:

```{r,out.width = '80%', fig.align='center'}
knitr::include_graphics("Imagen 3.png")
```

## Regresión sobre los datos

```{r,out.width = '80%', fig.align='center'}
knitr::include_graphics("Imagen 4.png")
```

```{r,out.width = '80%', fig.align='center'}
knitr::include_graphics("Imagen 5.png")
```

## Gráficamente

```{r,out.width = '80%', fig.align='center'}
knitr::include_graphics("Imagen 6.png")
```

```{r,out.width = '80%', fig.align='center'}
knitr::include_graphics("Imagen 7.png")
```

## Conclusiones del ejercicio

- La visualización de datos es útil porque nos permite explorar patrones que el cálculo de indicadores estadísticos muchas veces no permite
- La visualización es una parte importante del proceso exploratorio de datos
  - “El mayor valor de una imagen es cuando nos obliga a observar lo que no esperábamos ver”. — John Tukey

# Y ahora, ¿Qué sigue?

## En el proceso de generar visualizaciones es crucial

- Definir el objetivo: ¿Qué se quiere visualizar?
  - Categorías
  - Relaciones
  - Tendencias
  - Mix
- Tipos de variables
  - Categóricas: Ordenadas/No Ordenadas
  - Numéricas
  - Texto
- Número de Dimensiones

## Categorías

Podemos pensar en la categorización como una forma de agrupar los valores de una variable por alguna característica, en general, el tipo de variable.

- Si queremos mostrar cuántas observaciones tenemos dentro de una **variable categórica** existe el típico gráfico de conteo conocido como **barplot**

```{r,out.width = '60%', fig.align='center'}
knitr::include_graphics("Imagen 8.png")
```

## Categorías

En el caso de las **variables numéricas**, existe un caso particular de los barplot, conocido como **histograma**, en el cual se categoriza por un rango de valores dentro de la variable

```{r,out.width = '50%', fig.align='center'}
knitr::include_graphics("Imagen 9.png")
```

## Categorías

Una forma de mostrar la distribución de los posibles valores que puede tomar una **variable númerica**, es utilizar un **boxplot**. Éste gráfico muestra en la caja el rango de valores entre el primer y el tercer cuartil. Los “bigotes” mínimo y máximo se calculan como el quintil 1 y 3, menos y más 1,5 por el Rango intercuartílico (Q3-Q1), respectivamente. Fuera de esto están los valores atípicos. 

```{r,out.width = '40%', fig.align='center'}
knitr::include_graphics("Imagen 10.png")
```

## Categorías

Si lo que se quiere es mostrar cuánto del total de una variable categórica representa una categoría, una buena alternativa es un treemap, que divide en un rectángulo el valor proporcional que representa en la variable cada una de las categorías.

```{r,out.width = '50%', fig.align='center'}
knitr::include_graphics("Imagen 11.png")
```

## Relaciones

- Muchas veces nos va a interesar analizar la interacción entre variables.
- El caso clásico de gráfico de relaciones es el **scatterplot (o gráfico de puntos)**. En este se muestra el valor de dos **variables numéricas o una numérica y otra categórica** en un grafico de dos dimensiones (gráfico x e y), cada valor de la variable con su respectivo valor en la otra dimensión.
- Una forma de representar la relación de dos variables categóricas es utilizar el *diagrama de Sankey*. Éste muestra como se relacionan **dos variables categóricas** dado un “flujo”.

## Relaciones

```{r,out.width = '60%', fig.align='center'}
knitr::include_graphics("Imagen 12.png")
```


## Tendencia

- Las variables como el tiempo y el espacio son fundamentales en el desarrollo de muchas disciplinas, incluida la ciencia de datos. Por eso la relación entre ellas y otras variables se describe como tendencia y no como una relación común y corriente.
- Para mostrar una tendencia temporal de una **variable numérica**, generalmente se utiliza el **line plot (gráfico de línea)**, que es un caso particular del gráfico de puntos en el que se traza una línea entre cada punto consecutivo en el tiempo.

## Tendencia

```{r,out.width = '60%', fig.align='center'}
knitr::include_graphics("Imagen 13.png")
```

## Tendencia

- Los patrones que se pueden surgir entre la relación de una **variable categórica o númerica** y el **espacio geográfico** suelen generalmente representarse en un **choropleth**. Este gráfico tiene como estructura subyacente un mapa que tiene alguna división, donde cada división tomará un color distinto dependiendo de la categoría o si está dentro de un rango del valor de la variable.

```{r,out.width = '50%', fig.align='center'}
knitr::include_graphics("Imagen 14.png")
```

## Mix

Nuestro objetivos podrían ser múltiples. Existen muchos tipos de gráficos que nos permiten incorporar distintos elementos:

- Motion Chart

# Visualizaciones en R: ggplot2

## Las 3 B

- <b>B</b>ueno: Se ha consolidado como uno de los principales paquetes de R, está en el percentil 99 de descargas y es el paquete de visualización de datos más utilizado.

- <b>B</b>onito: Destaca por su sentido de la estética, el uso de colores, formas y su versatilidad. La estética no solo cumple el rol de resaltar lo "bonito", sino que aporta a la dimensionalidad en la visualización de datos.

- <b>B</b>arato: Es un paquete muy eficiente en la codificación: con unas pocas lineas se pueden conseguir excelentes visualizaciones. Además, R es gratis!

## ggplot2

- Basado en las ideas de Wilkinson et al. (2005), extendidas por Wickham (creador del paquete), plantean la "grammar of graphics" (grámatica de las gráficas) como una herramienta que permite describir los elementos de un gráfico.
- La idea central es que cualquier gráfico puede construirse usando estos tres componentes:
    - Datos
    - Coordenadas
    - Objetos Geométricos (geoms)
- Podemos agregar más dimensiones a nuestras gráficas cambiando detalles estéticos como:
    - Tamaño
    - Color
    - Formas
    
## ggplot2

```{r , eval=FALSE , echo=TRUE}
ggplot(data= <datos>, aes(<ejes>, <color>, <forma> ))+
  <función_geom>()
```

## ggplot2: Ejemplo 1

```{r , echo=TRUE}
cuadratica<-data.table(x=c(1:10)^2,y=c(1:10))
ggplot(data=cuadratica,aes(x=x,y=y))+geom_point()
```

## ggplot2: Ejemplo 2

```{r}
pond<- fread("ponderacion-notas.csv")
```


```{r}
pon<-ggplot(pond,aes(Opciones))+
  geom_bar()+
  labs(x="Opciones", y="Cantidad de personas", title = "Resultado votación para la ponderación de las evaluaciones", caption = "Fuente: Votación estudiantes DS4EyN" )+
  theme(axis.text.x=element_blank())
ggplotly(pon)
```
